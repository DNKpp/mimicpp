<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mimic++: finalizer</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">mimic++<span id="projectnumber">&#160;v7</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('db/d7a/group___e_x_p_e_c_t_a_t_i_o_n___f_i_n_a_l_i_z_e_r.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">finalizer<div class="ingroups"><a class="el" href="../../da/dbc/group___e_x_p_e_c_t_a_t_i_o_n.html">expectation</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Finalizers are the last step of a matching expectation.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for finalizer:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../db/d7a/group___e_x_p_e_c_t_a_t_i_o_n___f_i_n_a_l_i_z_e_r.svg" width="211" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gafe0fc1d77a4122b05f60d49183ce0106" id="r_gafe0fc1d77a4122b05f60d49183ce0106"><td class="memTemplParams" colspan="2">template&lt;typename Fun&gt; <br />
requires std::invocable&lt;std::remove_cvref_t&lt;Fun&gt;&amp;&gt; &amp;&amp; (!std::is_void_v&lt;std::invoke_result_t&lt;std::remove_cvref_t&lt;Fun&gt;&amp;&gt;&gt;)</td></tr>
<tr class="memitem:gafe0fc1d77a4122b05f60d49183ce0106"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#gafe0fc1d77a4122b05f60d49183ce0106">mimicpp::finally::returns_result_of</a> (Fun &amp;&amp;fun) noexcept(std::is_nothrow_constructible_v&lt; std::remove_cvref_t&lt; Fun &gt;, Fun &gt;)</td></tr>
<tr class="memdesc:gafe0fc1d77a4122b05f60d49183ce0106"><td class="mdescLeft">&#160;</td><td class="mdescRight">During the finalization step, the invocation result of the given function is returned.  <br /></td></tr>
<tr class="separator:gafe0fc1d77a4122b05f60d49183ce0106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaaa49d2747058448b5cc760ec9342400" id="r_gaaaa49d2747058448b5cc760ec9342400"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; <br />
requires std::copyable&lt;std::remove_cvref_t&lt;T&gt;&gt;</td></tr>
<tr class="memitem:gaaaa49d2747058448b5cc760ec9342400"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#gaaaa49d2747058448b5cc760ec9342400">mimicpp::finally::returns</a> (T &amp;&amp;value) noexcept(std::is_nothrow_constructible_v&lt; std::remove_cvref_t&lt; T &gt;, T &gt;)</td></tr>
<tr class="memdesc:gaaaa49d2747058448b5cc760ec9342400"><td class="mdescLeft">&#160;</td><td class="mdescRight">During the finalization step, the stored value is returned.  <br /></td></tr>
<tr class="separator:gaaaa49d2747058448b5cc760ec9342400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa520783da83f713847e7bd3f85ca4334" id="r_gaa520783da83f713847e7bd3f85ca4334"><td class="memTemplParams" colspan="2">template&lt;std::size_t index, std::size_t... otherIndices, typename Action&gt; </td></tr>
<tr class="memitem:gaa520783da83f713847e7bd3f85ca4334"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#gaa520783da83f713847e7bd3f85ca4334">mimicpp::finally::returns_apply_result_of</a> (Action &amp;&amp;action) noexcept(std::is_nothrow_constructible_v&lt; std::remove_cvref_t&lt; Action &gt;, Action &gt;)</td></tr>
<tr class="memdesc:gaa520783da83f713847e7bd3f85ca4334"><td class="mdescLeft">&#160;</td><td class="mdescRight">During the finalization step, the selected call arguments are applied on the given action.  <br /></td></tr>
<tr class="separator:gaa520783da83f713847e7bd3f85ca4334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d9822641f9c22aae3eccc2a16136718" id="r_ga1d9822641f9c22aae3eccc2a16136718"><td class="memTemplParams" colspan="2">template&lt;typename Action&gt; </td></tr>
<tr class="memitem:ga1d9822641f9c22aae3eccc2a16136718"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ga1d9822641f9c22aae3eccc2a16136718">mimicpp::finally::returns_apply_all_result_of</a> (Action &amp;&amp;action) noexcept(std::is_nothrow_constructible_v&lt; std::remove_cvref_t&lt; Action &gt;, Action &gt;)</td></tr>
<tr class="memdesc:ga1d9822641f9c22aae3eccc2a16136718"><td class="mdescLeft">&#160;</td><td class="mdescRight">During the finalization step, all call arguments are applied on the given action.  <br /></td></tr>
<tr class="separator:ga1d9822641f9c22aae3eccc2a16136718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1ce10575d208bda2ed786798243e214" id="r_gaf1ce10575d208bda2ed786798243e214"><td class="memTemplParams" colspan="2">template&lt;std::size_t index&gt; </td></tr>
<tr class="memitem:gaf1ce10575d208bda2ed786798243e214"><td class="memTemplItemLeft" align="right" valign="top">consteval auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#gaf1ce10575d208bda2ed786798243e214">mimicpp::finally::returns_arg</a> () noexcept</td></tr>
<tr class="memdesc:gaf1ce10575d208bda2ed786798243e214"><td class="mdescLeft">&#160;</td><td class="mdescRight">During the finalization step, the selected call argument is returned.  <br /></td></tr>
<tr class="separator:gaf1ce10575d208bda2ed786798243e214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4f67d2c48ef5ebaf25e31e2ac59c5c1" id="r_gab4f67d2c48ef5ebaf25e31e2ac59c5c1"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; <br />
requires std::copyable&lt;std::remove_cvref_t&lt;T&gt;&gt;</td></tr>
<tr class="memitem:gab4f67d2c48ef5ebaf25e31e2ac59c5c1"><td class="memTemplItemLeft" align="right" valign="top">constexpr <a class="el" href="../../d8/d34/classmimicpp_1_1expectation__policies_1_1_throws.html">expectation_policies::Throws</a>&lt; std::remove_cvref_t&lt; T &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#gab4f67d2c48ef5ebaf25e31e2ac59c5c1">mimicpp::finally::throws</a> (T &amp;&amp;exception) noexcept(std::is_nothrow_constructible_v&lt; std::remove_cvref_t&lt; T &gt;, T &gt;)</td></tr>
<tr class="memdesc:gab4f67d2c48ef5ebaf25e31e2ac59c5c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">During the finalization step, the given exception is thrown.  <br /></td></tr>
<tr class="separator:gab4f67d2c48ef5ebaf25e31e2ac59c5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Finalizers are the last step of a matching expectation. </p>
<p>Finalizers are executed for calls, which have a matching expectation. They are responsible for either returning an appropriate return value or leaving the call by throwing an exception.</p>
<p>An expectation must have exactly one finalizer applied. For mocks returning void, an appropriate finalizer is attached by default. This default finalizer can be exchanged once. If an expectation setup contains multiple finalize statements, a compile error is triggered.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Custom Finalizers</h1>
<p>There are several provided finalizers, but user may create their own as desired. A valid finalizer has to satisfy the <code><a class="el" href="../../d9/d64/conceptmimicpp_1_1finalize__policy__for.html" title="Determines, whether the given type satisfies the requirements of a finalize-policy for the given sign...">finalize_policy_for</a></code> concept, which in fact requires the existence of a <code>finalize_call</code> member function. </p><div class="fragment"><div class="line">    <span class="keyword">class </span>MyFinalizer</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keywordtype">int</span> finalize_call([[maybe_unused]] <span class="keyword">const</span> mimicpp::call::Info&lt;int&gt;&amp; callInfo)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> 1337;</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;int()&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call()</div>
<div class="line">        and MyFinalizer{};</div>
<div class="line"> </div>
<div class="line">    REQUIRE(1337 == mock());</div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="gaaaa49d2747058448b5cc760ec9342400" name="gaaaa49d2747058448b5cc760ec9342400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaaa49d2747058448b5cc760ec9342400">&#9670;&#160;</a></span>returns()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; <br />
requires std::copyable&lt;std::remove_cvref_t&lt;T&gt;&gt;</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto mimicpp::finally::returns </td>
          <td>(</td>
          <td class="paramtype">T &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel nodiscard">nodiscard</span><span class="mlabel constexpr">constexpr</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>During the finalization step, the stored value is returned. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The value type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value to be returned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a copy of <code>value</code>.</dd></dl>
<p>The provided value must be copyable, because multiple invocations must be possible. </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;int()&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call()</div>
<div class="line">        and finally::returns(42);</div>
<div class="line"> </div>
<div class="line">    REQUIRE(42 == mock());</div>
</div><!-- fragment --><p>This finalizer is aware of <code>std::reference_wrapper</code>, which can be used to return values from the outer scope. Such values are explicitly unwrapped, before they are returned. </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;<span class="keywordtype">int</span>&amp;()&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> myReturn{42};</div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call()</div>
<div class="line">        and finally::returns(std::ref(myReturn));</div>
<div class="line"> </div>
<div class="line">    REQUIRE(&amp;myReturn == &amp;mock());</div>
</div><!-- fragment --><p>In fact any value category can be returned; it is the users responsibility to make sure, not to use any dangling references. If an actual value is stored and a reference is returned, this is fine until the expectation goes out of scope. </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line">    <span class="keyword">namespace </span>expect = <a class="code hl_namespace" href="../../d3/d18/namespacemimicpp_1_1expect.html">mimicpp::expect</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;<span class="keywordtype">int</span>&amp;()&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call()</div>
<div class="line">        and expect::twice() <span class="comment">// we call the mock two times</span></div>
<div class="line">        and finally::returns(42);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span>&amp; result = mock();</div>
<div class="line">    REQUIRE(42 == result); <span class="comment">// fine</span></div>
<div class="line"> </div>
<div class="line">    result = 1337;</div>
<div class="line">    REQUIRE(1337 == mock());</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga1d9822641f9c22aae3eccc2a16136718" name="ga1d9822641f9c22aae3eccc2a16136718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d9822641f9c22aae3eccc2a16136718">&#9670;&#160;</a></span>returns_apply_all_result_of()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Action&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto mimicpp::finally::returns_apply_all_result_of </td>
          <td>(</td>
          <td class="paramtype">Action &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>action</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel nodiscard">nodiscard</span><span class="mlabel constexpr">constexpr</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>During the finalization step, all call arguments are applied on the given action. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Action</td><td>The action type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>The action to be applied to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the invocation result of the given action.</dd></dl>
<p>All call arguments are applied as (possibly const qualified) lvalue-references. The action may proceed with them as desired, but be aware that this may actually affect objects outside the call (e.g. if call arguments are lvalues.). </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;int(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>)&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call(1337, 42)</div>
<div class="line">        and finally::returns_apply_all_result_of(std::plus{});</div>
<div class="line"> </div>
<div class="line">    REQUIRE(1379 == mock(1337, 42));</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gaa520783da83f713847e7bd3f85ca4334" name="gaa520783da83f713847e7bd3f85ca4334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa520783da83f713847e7bd3f85ca4334">&#9670;&#160;</a></span>returns_apply_result_of()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;std::size_t index, std::size_t... otherIndices, typename Action&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto mimicpp::finally::returns_apply_result_of </td>
          <td>(</td>
          <td class="paramtype">Action &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>action</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel nodiscard">nodiscard</span><span class="mlabel constexpr">constexpr</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>During the finalization step, the selected call arguments are applied on the given action. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">index</td><td>The first selected argument index. </td></tr>
    <tr><td class="paramname">otherIndices</td><td>Addition selected arguments. </td></tr>
    <tr><td class="paramname">Action</td><td>The action type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>The action to be applied to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the invocation result of the given action.</dd></dl>
<p>The selected call arguments are applied as (possibly const qualified) lvalue-references. The action may proceed with them as desired, but be aware that this may actually affect objects outside the call (e.g. if call arguments are lvalues.). </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;int(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>)&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call(1337, 42)</div>
<div class="line">        and finally::returns_apply_result_of&lt;0, 1&gt;(std::plus{});</div>
<div class="line"> </div>
<div class="line">    REQUIRE(1379 == mock(1337, 42));</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gaf1ce10575d208bda2ed786798243e214" name="gaf1ce10575d208bda2ed786798243e214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf1ce10575d208bda2ed786798243e214">&#9670;&#160;</a></span>returns_arg()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;std::size_t index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto mimicpp::finally::returns_arg </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel nodiscard">nodiscard</span><span class="mlabel consteval">consteval</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>During the finalization step, the selected call argument is returned. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns the forwarded and explicitly converted argument.</dd></dl>
<p>The selected call argument is forwarded and explicitly converted to the mocks return type. </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;int(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>)&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call(1337, 42)</div>
<div class="line">        and finally::returns_arg&lt;1&gt;();</div>
<div class="line"> </div>
<div class="line">    REQUIRE(42 == mock(1337, 42));</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gafe0fc1d77a4122b05f60d49183ce0106" name="gafe0fc1d77a4122b05f60d49183ce0106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe0fc1d77a4122b05f60d49183ce0106">&#9670;&#160;</a></span>returns_result_of()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Fun&gt; <br />
requires std::invocable&lt;std::remove_cvref_t&lt;Fun&gt;&amp;&gt; &amp;&amp; (!std::is_void_v&lt;std::invoke_result_t&lt;std::remove_cvref_t&lt;Fun&gt;&amp;&gt;&gt;)</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto mimicpp::finally::returns_result_of </td>
          <td>(</td>
          <td class="paramtype">Fun &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>fun</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel nodiscard">nodiscard</span><span class="mlabel constexpr">constexpr</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>During the finalization step, the invocation result of the given function is returned. </p>
<div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;std::string()&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call()</div>
<div class="line">        and finally::returns_result_of([] { <span class="keywordflow">return</span> <span class="stringliteral">&quot;Hello, World!&quot;</span>; });</div>
<div class="line"> </div>
<div class="line">    REQUIRE(<span class="stringliteral">&quot;Hello, World!&quot;</span> == mock());</div>
</div><!-- fragment --> <dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Fun</td><td>The function type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fun</td><td>The function to be invoked. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Forward returns the invocation result of <code>fun</code>.</dd></dl>
<p>The provided functions must be invocable without arguments, but may return any type, which is explicitly convertible to the mocks return type. </p>

</div>
</div>
<a id="gab4f67d2c48ef5ebaf25e31e2ac59c5c1" name="gab4f67d2c48ef5ebaf25e31e2ac59c5c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4f67d2c48ef5ebaf25e31e2ac59c5c1">&#9670;&#160;</a></span>throws()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; <br />
requires std::copyable&lt;std::remove_cvref_t&lt;T&gt;&gt;</div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d34/classmimicpp_1_1expectation__policies_1_1_throws.html">expectation_policies::Throws</a>&lt; std::remove_cvref_t&lt; T &gt; &gt; mimicpp::finally::throws </td>
          <td>(</td>
          <td class="paramtype">T &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>exception</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel nodiscard">nodiscard</span><span class="mlabel constexpr">constexpr</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>During the finalization step, the given exception is thrown. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The exception type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>The exception to be thrown. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">A</td><td>copy of <code>exception</code>.</td></tr>
  </table>
  </dd>
</dl>
<p>The provided exception must be copyable, because multiple invocations must be possible. </p><div class="fragment"><div class="line">    <span class="keyword">namespace </span>finally = <a class="code hl_namespace" href="../../d2/d8d/namespacemimicpp_1_1finally.html">mimicpp::finally</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d2/d48/classmimicpp_1_1_mock.html">mimicpp::Mock</a>&lt;int()&gt; mock{};</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="../../d8/d12/group___m_o_c_k.html#ga7e7d68eefb8f3cba28422f62bcf2f90a">SCOPED_EXP</a> mock.expect_call()</div>
<div class="line">        and finally::throws(std::runtime_error{<span class="stringliteral">&quot;Something happened.&quot;</span>});</div>
<div class="line"> </div>
<div class="line">    REQUIRE_THROWS_AS(</div>
<div class="line">        mock(),</div>
<div class="line">        std::runtime_error);</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue May 6 2025 for mimic++ by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
